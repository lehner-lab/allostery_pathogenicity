% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={1.hpc\_fig1},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{1.hpc\_fig1}
\author{}
\date{\vspace{-2.5em}2025-06-16}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{all\_var\_r2 }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/all\_var\_lm\_r2.csv"}\NormalTok{)}
\NormalTok{all\_var\_r2 }\OtherTok{\textless{}{-}}\NormalTok{ all\_var\_r2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(adj\_r2))}
\FunctionTok{nrow}\NormalTok{(all\_var\_r2) }\CommentTok{\#19804}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 19804
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\#0.2243766}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2243766
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.1730944}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1730944
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\FloatTok{0.25}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.1250503 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       25% 
## 0.1250503
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\FloatTok{0.75}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.2981447}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       75% 
## 0.2981447
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{core\_var\_r2 }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/core\_lm\_r2.csv"}\NormalTok{)}
\FunctionTok{nrow}\NormalTok{(core\_var\_r2) }\CommentTok{\#17420}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 17420
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2)) }\CommentTok{\#17420}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 17420
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\#0.1581737}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1581737
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{IQR}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.1356202}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.1356202
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\FloatTok{0.25}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.09595388}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        25% 
## 0.09595388
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{quantile}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\FloatTok{0.75}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) }\CommentTok{\#0.2315741 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       75% 
## 0.2315741
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# \# Use multiple sessions (parallel workers)}
\CommentTok{\# plan(multisession)}
\CommentTok{\# }
\CommentTok{\# \# Set the directory path where your RDS files are stored}
\CommentTok{\# dir\_path \textless{}{-} "/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/00.human\_proteome\_results/lm\_rds/"}
\CommentTok{\# }
\CommentTok{\# \# List all RDS files in the directory}
\CommentTok{\# rds\_files \textless{}{-} list.files(path = dir\_path, pattern = "\textbackslash{}\textbackslash{}\_lm.rds$", full.names = TRUE)}
\CommentTok{\# }
\CommentTok{\# safe\_read\_and\_count \textless{}{-} safely(function(file) \{}
\CommentTok{\#   lm\_rds \textless{}{-} readRDS(file)}
\CommentTok{\#   if (!is.null(lm\_rds$predicted\_data)) \{}
\CommentTok{\#     sum(rowSums(!is.na(lm\_rds$predicted\_data)) \textgreater{} 0)}
\CommentTok{\#   \} else \{}
\CommentTok{\#     0}
\CommentTok{\#   \}}
\CommentTok{\# \})}
\CommentTok{\# }
\CommentTok{\# results \textless{}{-} future\_map(rds\_files, safe\_read\_and\_count)}
\CommentTok{\# }
\CommentTok{\# \# Extract row counts (default to 0 if error)}
\CommentTok{\# row\_counts \textless{}{-} map\_int(results, \textasciitilde{} if (is.null(.x$error)) .x$result else 0)}
\CommentTok{\# }
\CommentTok{\# \# Identify files with errors}
\CommentTok{\# error\_files \textless{}{-} rds\_files[which(!map\_lgl(results, \textasciitilde{} is.null(.x$error)))]}
\CommentTok{\# }
\CommentTok{\# \# Print or save}
\CommentTok{\# writeLines(error\_files, "corrupted\_rds\_files.txt")}
\CommentTok{\#Total number of rows in predicted\_data across all RDS files: 193469108}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# \# Use multiple sessions (parallel workers)}
\CommentTok{\# future::plan(multisession)}
\CommentTok{\# }
\CommentTok{\# \# Set the directory path where your RDS files are stored}
\CommentTok{\# core\_dir\_path \textless{}{-} "/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/00.human\_proteome\_results/core\_lm\_rds"}
\CommentTok{\# }
\CommentTok{\# \# List all RDS files in the directory}
\CommentTok{\# core\_rds\_files \textless{}{-} list.files(path = core\_dir\_path, pattern = "\textbackslash{}\textbackslash{}\_lm.rds", full.names = TRUE)}
\CommentTok{\# length(core\_rds\_files) \#17420}
\CommentTok{\# }
\CommentTok{\# \#nrow(readRDS(rds\_files[1])$predicted\_data)}
\CommentTok{\# \#sum(rowSums(!is.na(readRDS(rds\_files[1])$predicted\_data)) \textgreater{} 0)}
\CommentTok{\# core\_results \textless{}{-} future\_map(core\_rds\_files, safe\_read\_and\_count)}
\CommentTok{\# }
\CommentTok{\# \# Extract row counts (default to 0 if error)}
\CommentTok{\# core\_row\_counts \textless{}{-} map\_int(core\_results, \textasciitilde{} if (is.null(.x$error)) .x$result else 0)}
\CommentTok{\# }
\CommentTok{\# \# Identify files with errors}
\CommentTok{\# core\_error\_files \textless{}{-} rds\_files[which(!map\_lgl(core\_results, \textasciitilde{} is.null(.x$error)))]}
\CommentTok{\# }
\CommentTok{\# core\_error\_files}
\CommentTok{\# \#character(0)}
\CommentTok{\# \# Sum up the total rows}
\CommentTok{\# core\_total\_rows \textless{}{-} sum(core\_row\_counts)}
\CommentTok{\# }
\CommentTok{\# \# Print the result}
\CommentTok{\# cat("Total number of rows in predicted\_data across all RDS files:", core\_total\_rows, "\textbackslash{}n")}
\CommentTok{\# \#Total number of rows in predicted\_data across all RDS files: 47841329 }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r2\_combined }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(}
\NormalTok{  all\_var\_r2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{source =} \StringTok{"All"}\NormalTok{),}
\NormalTok{  core\_var\_r2 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{source =} \StringTok{"Core"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#min(all\_var\_r2$adj\_r2) \#{-}0.004163465}

\CommentTok{\# Count summaries}
\NormalTok{n\_all }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{protein\_id))}
\NormalTok{n\_var\_all }\OtherTok{\textless{}{-}} \DecValTok{193469108}

\NormalTok{n\_core }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{protein\_id))}
\NormalTok{n\_var\_core }\OtherTok{\textless{}{-}} \DecValTok{47841329}

\CommentTok{\# Median R²s}
\NormalTok{med\_all }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(all\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\#0.2243766}
\NormalTok{med\_core }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{adj\_r2) }\CommentTok{\#0.1581737}

\CommentTok{\# Rename column to standardize}
\NormalTok{r2\_combined }\OtherTok{\textless{}{-}}\NormalTok{ r2\_combined  }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{source =} \FunctionTok{factor}\NormalTok{(source, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"All"}\NormalTok{, }\StringTok{"Core"}\NormalTok{)))}

\CommentTok{\# Plot}
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(r2\_combined, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ source, }\AttributeTok{y =}\NormalTok{ adj\_r2, }\AttributeTok{fill =}\NormalTok{ source)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{trim =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{outlier.shape =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{color =} \StringTok{"grey"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \CommentTok{\#stat\_summary(fun = median, geom = "crossbar", width = 0.4, color = "black", fatten = 1) +}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{stat =} \StringTok{"summary"}\NormalTok{, }\AttributeTok{fun =}\NormalTok{ median, }\AttributeTok{shape =} \DecValTok{18}\NormalTok{, }\AttributeTok{size =} \DecValTok{4}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"Median R²: "}\NormalTok{, }\FunctionTok{round}\NormalTok{(..y.., }\DecValTok{3}\NormalTok{))),}
            \AttributeTok{stat =} \StringTok{"summary"}\NormalTok{, }\AttributeTok{fun =}\NormalTok{ median, }\AttributeTok{vjust =} \SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \FloatTok{4.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{1}\NormalTok{, }\AttributeTok{y =} \FloatTok{0.87}\NormalTok{, }\AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(n\_all, }\StringTok{" proteins}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{format}\NormalTok{(n\_var\_all, }\AttributeTok{big.mark =} \StringTok{","}\NormalTok{), }\StringTok{" variants"}\NormalTok{), }\AttributeTok{size =} \FloatTok{4.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{2}\NormalTok{, }\AttributeTok{y =} \FloatTok{0.87}\NormalTok{, }\AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(n\_core, }\StringTok{" proteins}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{, }\FunctionTok{format}\NormalTok{(n\_var\_core, }\AttributeTok{big.mark =} \StringTok{","}\NormalTok{), }\StringTok{" variants"}\NormalTok{), }\AttributeTok{size =} \FloatTok{4.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.1}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{expand =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.01}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Human Proteome"}\NormalTok{,}
    \AttributeTok{subtitle =} \FunctionTok{paste}\NormalTok{(n\_all, }\StringTok{"proteins"}\NormalTok{),}
    \AttributeTok{x =} \ConstantTok{NULL}\NormalTok{,}
    \AttributeTok{y =} \FunctionTok{expression}\NormalTok{(}\StringTok{"R² between ddGf and ESM1v pathogenicity"}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"skyblue1"}\NormalTok{, }\StringTok{"steelblue3"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{(}\AttributeTok{base\_size =} \DecValTok{14}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{13}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}
\NormalTok{  )}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_r2.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p1, }\AttributeTok{width =} \DecValTok{5}\NormalTok{, }\AttributeTok{height =} \DecValTok{4}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.
## i Please use `after_stat(y)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{protein\_atlas\_anno }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/idmapping\_gene\_name.tsv"}\NormalTok{)}
\FunctionTok{nrow}\NormalTok{(protein\_atlas\_anno)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 329154
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(protein\_atlas\_anno}\SpecialCharTok{$}\NormalTok{source\_file)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##       accessory_factors_involved_in_transport 
##                                          3418 
##                  blood_group_antigen_proteins 
##                                          1303 
##                                    cd_markers 
##                                          3954 
##            citric_acid_cycle_related_proteins 
##                                           262 
## electrochemical_potential_driven_transporters 
##                                          2351 
##                               enzyme_proteins 
##                                         22971 
##                   G_protein_coupled_receptors 
##                                          2418 
##                          immunoglobulin_genes 
##                                           279 
##                                       kinases 
##                                          3589 
##                            metabolic_proteins 
##                                         18134 
##                             nuclear_receptors 
##                                           468 
##                                    peptidases 
##                                          2981 
##                               plasma_proteins 
##                                         49016 
##              predicted_intracellular_proteins 
##                                        119025 
##                   predicted_membrane_proteins 
##                                         72856 
##                   predicted_secreted_proteins 
##                                          8567 
##                   primary_active_transporters 
##                                          1411 
##                  RAS_pathway_related_proteins 
##                                          1585 
##                            ribosomal_proteins 
##                                           836 
##               RNA_polymerase_related_proteins 
##                                           169 
##                         T-cell_receptor_genes 
##                                           241 
##                          transcription_factor 
##                                          7737 
##                   transport_electron_carriers 
##                                           105 
##                transporter_channels_and_pores 
##                                          4628 
##                    voltage-gated_ion_channels 
##                                           850
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#core\_var\_r2$protein\_id \textless{}{-} sub("\_filtered\_with\_esm1v\textbackslash{}\textbackslash{}.csv$", "", core\_var\_r2$protein\_id)}
\CommentTok{\#write.csv(core\_var\_r2, "/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/core\_lm\_r2.csv", row.names = FALSE)}

\NormalTok{core\_var\_r2\_anno }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(core\_var\_r2, protein\_atlas\_anno, }\AttributeTok{by.x=}\StringTok{"protein\_id"}\NormalTok{, }\AttributeTok{by.y=}\StringTok{"uniprot"}\NormalTok{, }\AttributeTok{all.x =} \ConstantTok{TRUE}\NormalTok{ )}
\FunctionTok{nrow}\NormalTok{(core\_var\_r2\_anno)}\CommentTok{\#35710\textless{}{-} same protein can be part of multiple groups }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 35710
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(core\_var\_r2}\SpecialCharTok{$}\NormalTok{protein\_id)) }\CommentTok{\#17420}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 17420
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{core\_var\_r2\_anno}\SpecialCharTok{$}\NormalTok{source\_file }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_"}\NormalTok{, }\StringTok{" "}\NormalTok{, core\_var\_r2\_anno}\SpecialCharTok{$}\NormalTok{source\_file)}

\NormalTok{core\_var\_r2\_anno }\OtherTok{\textless{}{-}}\NormalTok{ core\_var\_r2\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(source\_file))}
\FunctionTok{nrow}\NormalTok{(core\_var\_r2\_anno) }\CommentTok{\#35121}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 35121
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary }\OtherTok{\textless{}{-}}\NormalTok{ core\_var\_r2\_anno }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(source\_file) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{count =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{median\_value =} \FunctionTok{median}\NormalTok{(adj\_r2)}
\NormalTok{  )}

\NormalTok{p6 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(core\_var\_r2\_anno, }\FunctionTok{aes}\NormalTok{(}
  \AttributeTok{x =}\NormalTok{ source\_file,}
  \AttributeTok{y =}\NormalTok{ adj\_r2}
\NormalTok{)) }\SpecialCharTok{+}
  \CommentTok{\# Sample size annotation}
  \FunctionTok{geom\_text}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ summary, }
    \FunctionTok{aes}\NormalTok{(}
      \AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(source\_file, }\SpecialCharTok{{-}}\NormalTok{median\_value), }
      \AttributeTok{y =} \FloatTok{0.8}\NormalTok{,}
      \AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"n="}\NormalTok{, count)}
\NormalTok{    ), }
    \AttributeTok{size =} \FloatTok{3.5}\NormalTok{, }
    \AttributeTok{color =} \StringTok{"black"}
\NormalTok{  ) }\SpecialCharTok{+}
  \CommentTok{\# Violin plot with fixed color}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{trim =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#0072B2"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# All violins same color}

  \CommentTok{\# Mean point}
  \FunctionTok{stat\_summary}\NormalTok{(}
    \AttributeTok{fun =}\NormalTok{ median, }
    \AttributeTok{geom =} \StringTok{"point"}\NormalTok{, }
    \AttributeTok{shape =} \DecValTok{21}\NormalTok{, }
    \AttributeTok{size =} \DecValTok{1}\NormalTok{, }
    \AttributeTok{color =} \StringTok{"black"}\NormalTok{, }
    \AttributeTok{fill =} \StringTok{"black"}
\NormalTok{  ) }\SpecialCharTok{+}

  \CommentTok{\# Mean label}
  \FunctionTok{stat\_summary}\NormalTok{(}
    \AttributeTok{fun =}\NormalTok{ median, }
    \AttributeTok{geom =} \StringTok{"text"}\NormalTok{, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(..y.., }\DecValTok{2}\NormalTok{)), }
    \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }
    \AttributeTok{size =} \FloatTok{3.5}\NormalTok{, }
    \AttributeTok{color =} \StringTok{"black"}
\NormalTok{  ) }\SpecialCharTok{+}

  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"47,841,329 Variants (Protein Cores)"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Protein cores excluding binding sites"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{""}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"R²"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{, }\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.line =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{size =} \FloatTok{0.6}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{ylim}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
## i Please use the `linewidth` argument instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{range}\NormalTok{(core\_var\_r2\_anno}\SpecialCharTok{$}\NormalTok{adj\_r2) }\CommentTok{\# {-}0.05881657  0.86482045}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.05881657  0.86482045
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_r2\_protein\_type.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p6, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 160 rows containing missing values or values outside the scale range
## (`geom_violin()`).
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p6}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 160 rows containing missing values or values outside the scale range
## (`geom_violin()`).
\end{verbatim}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-5-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/00.human\_proteome\_results/clinvar\_all\_protein\_filtered\_with\_esm1v\_new.csv"}\NormalTok{)}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var) }\CommentTok{\#114903}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 114903
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(ESM}\FloatTok{.1}\NormalTok{v)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(ddG\_pred)) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(variant, Model, Dataset, ddG\_pred, ESM}\FloatTok{.1}\NormalTok{v, new\_position, wildtype, mutation,}
\NormalTok{                exposure\_rasa, spot\_disorder, clinvar\_clinical\_significance, chain, uniprot, }
\NormalTok{                aa\_sequence)}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var) }\CommentTok{\#113994}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 113994
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#write.csv(clinvar\_all\_var, "/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/20250616\_clinvar\_proteome.csv", row.names = FALSE)}

\NormalTok{total\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"pathogenic"}\NormalTok{, }\StringTok{"likely\_pathogenic"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(total\_patho) }\CommentTok{\#42576}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 42576
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"likely\_benign"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(total\_benign) }\CommentTok{\#71418}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 71418
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{stability =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    ddG\_pred }\SpecialCharTok{\textgreater{}} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"destabilizing"}\NormalTok{,}
\NormalTok{    ddG\_pred }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\FloatTok{0.5} \SpecialCharTok{\textasciitilde{}} \StringTok{"stabilizing"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"WT{-}like"}  \CommentTok{\# Default case}
\NormalTok{  ))}

\CommentTok{\# Summarize data by categories and pathogenicity}
\NormalTok{summary\_df }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{clinvar\_clinical\_significance =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"likely\_benign"}\NormalTok{, }\StringTok{"benign"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"benign"}\NormalTok{,}
\NormalTok{    clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"likely\_pathogenic"}\NormalTok{, }\StringTok{"pathogenic"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"pathogenic"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\NormalTok{ clinvar\_clinical\_significance  }\CommentTok{\# Keep other categories unchanged}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%}
  \CommentTok{\# Group by the new clinical significance categories and stability}
  \FunctionTok{group\_by}\NormalTok{(clinvar\_clinical\_significance, stability) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{(), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \CommentTok{\# Recalculate percentages after merging}
  \FunctionTok{group\_by}\NormalTok{(clinvar\_clinical\_significance) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{percent =}\NormalTok{ (count }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(count)) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\NormalTok{summary\_df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
##   clinvar_clinical_significance stability     count percent
##   <chr>                         <chr>         <int>   <dbl>
## 1 benign                        WT-like       63944   89.5 
## 2 benign                        destabilizing  6292    8.81
## 3 benign                        stabilizing    1182    1.66
## 4 pathogenic                    WT-like       21125   49.6 
## 5 pathogenic                    destabilizing 20549   48.3 
## 6 pathogenic                    stabilizing     902    2.12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Creating a contingency table}
\NormalTok{contingency\_table }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
\NormalTok{  summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"pathogenic"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{==} \StringTok{"destabilizing"}\NormalTok{], }
\NormalTok{  summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"benign"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{==} \StringTok{"destabilizing"}\NormalTok{],}
  \FunctionTok{sum}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"pathogenic"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{!=} \StringTok{"destabilizing"}\NormalTok{]),}
  \FunctionTok{sum}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"benign"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{!=} \StringTok{"destabilizing"}\NormalTok{])}
\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Adding row and column names for clarity}
\FunctionTok{colnames}\NormalTok{(contingency\_table) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Pathogenic"}\NormalTok{, }\StringTok{"Benign"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(contingency\_table) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Destabilizing"}\NormalTok{, }\StringTok{"Non{-}Destabilizing"}\NormalTok{)}

\CommentTok{\# Displaying the table}
\FunctionTok{print}\NormalTok{(contingency\_table)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   Pathogenic Benign
## Destabilizing          20549   6292
## Non-Destabilizing      22027  65126
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#                  Pathogenic Benign}
\CommentTok{\#Destabilizing          20549   6292}
\CommentTok{\#Non{-}Destabilizing      22027  65126}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the Odds Ratio using Fisher\textquotesingle{}s Test}
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{fisher.test}\NormalTok{(contingency\_table)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Fisher's Exact Test for Count Data
## 
## data:  contingency_table
## p-value < 2.2e-16
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  9.352171 9.975718
## sample estimates:
## odds ratio 
##    9.65372
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#   Fisher\textquotesingle{}s Exact Test for Count Data}
\CommentTok{\# }
\CommentTok{\# data:  contingency\_table}
\CommentTok{\# p{-}value \textless{} 2.2e{-}16}
\CommentTok{\# alternative hypothesis: true odds ratio is not equal to 1}
\CommentTok{\# 95 percent confidence interval:}
\CommentTok{\#  9.352171 9.975718}
\CommentTok{\# sample estimates:}
\CommentTok{\# odds ratio }
\CommentTok{\#    9.65372 }
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# library(pROC)}
\CommentTok{\# library(PRROC)}
\CommentTok{\# }
\CommentTok{\# \# Create expanded binary vectors}
\CommentTok{\# y\_true \textless{}{-} c(}
\CommentTok{\#   rep(1, 20549),  \# pathogenic destabilizing}
\CommentTok{\#   rep(1, 22027),  \# pathogenic non{-}destabilizing}
\CommentTok{\#   rep(0, 6292),   \# benign destabilizing}
\CommentTok{\#   rep(0, 65126)   \# benign non{-}destabilizing}
\CommentTok{\# )}
\CommentTok{\# }
\CommentTok{\# \# Predicted labels or scores: 1 for destabilizing, 0 for not}
\CommentTok{\# y\_pred \textless{}{-} c(}
\CommentTok{\#   rep(1, 20549),  \# pathogenic destabilizing}
\CommentTok{\#   rep(0, 22027),  \# pathogenic non{-}destabilizing}
\CommentTok{\#   rep(1, 6292),   \# benign destabilizing}
\CommentTok{\#   rep(0, 65126)   \# benign non{-}destabilizing}
\CommentTok{\# )}
\CommentTok{\# }
\CommentTok{\# \# ROC AUC}
\CommentTok{\# roc\_obj \textless{}{-} roc(y\_true, y\_pred)}
\CommentTok{\# roc\_auc \textless{}{-} auc(roc\_obj)}
\CommentTok{\# }
\CommentTok{\# \# PR AUC}
\CommentTok{\# pr\_obj \textless{}{-} pr.curve(scores.class0 = y\_pred[y\_true == 1],}
\CommentTok{\#                    scores.class1 = y\_pred[y\_true == 0],}
\CommentTok{\#                    curve = TRUE)}
\CommentTok{\# pr\_auc \textless{}{-} pr\_obj$auc.integral}
\CommentTok{\# }
\CommentTok{\# \# Print results}
\CommentTok{\# cat("ROC{-}AUC:", round(roc\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#ROC{-}AUC: 0.6973 }
\CommentTok{\# cat("PR{-}AUC:", round(pr\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#PR{-}AUC: 0.6184}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_df}\SpecialCharTok{$}\NormalTok{stability }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{stability, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"WT{-}like"}\NormalTok{, }\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{))}
\NormalTok{summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"pathogenic"}\NormalTok{))}

\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var) }\CommentTok{\#113994}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 113994
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(clinvar\_all\_var}\SpecialCharTok{$}\NormalTok{uniprot)) }\CommentTok{\#12336}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 12336
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p7 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(summary\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ clinvar\_clinical\_significance, }\AttributeTok{y =}\NormalTok{ percent, }\AttributeTok{fill =}\NormalTok{ stability)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"stack"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Stacked bars}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(}\FunctionTok{round}\NormalTok{(percent, }\DecValTok{1}\NormalTok{), }\StringTok{"\% ("}\NormalTok{, count, }\StringTok{")"}\NormalTok{)), }
            \AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{), }\AttributeTok{size =} \DecValTok{4}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Center labels in stacks}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set2"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"113,994 ClinVar Variants"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"12,336 proteins"}\NormalTok{,}
       \AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \StringTok{"Variant percentage (\%)"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{101}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
        \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{),}
        \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{) ,}
        \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{) ,}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{))        }

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_all\_var\_clinvar\_barplot.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p7, }\AttributeTok{width =} \DecValTok{4}\NormalTok{, }\AttributeTok{height =} \DecValTok{4}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p7}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/20250616\_clinvar\_proteome\_core.csv"}\NormalTok{)}

\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil) }\CommentTok{\#30744}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30455
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(ESM}\FloatTok{.1}\NormalTok{v)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(ddG\_pred)) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{select}\NormalTok{(variant, Model, Dataset, ddG\_pred, ESM}\FloatTok{.1}\NormalTok{v, new\_position, wildtype, mutation,}
\NormalTok{                exposure\_rasa, spot\_disorder, clinvar\_clinical\_significance, chain, uniprot, }
\NormalTok{                aa\_sequence)}
\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil) }\CommentTok{\#30455}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30455
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#write.csv(clinvar\_core\_fil, "/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/data/proteome\_meta/20250616\_clinvar\_proteome\_core.csv", row.names = FALSE)}

\NormalTok{total\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"pathogenic"}\NormalTok{, }\StringTok{"likely\_pathogenic"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(total\_patho) }\CommentTok{\#20765}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 20765
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"likely\_benign"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(total\_benign) }\CommentTok{\#9690}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9690
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{stability =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    ddG\_pred }\SpecialCharTok{\textgreater{}} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"destabilizing"}\NormalTok{,}
\NormalTok{    ddG\_pred }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\FloatTok{0.5} \SpecialCharTok{\textasciitilde{}} \StringTok{"stabilizing"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"WT{-}like"}  \CommentTok{\# Default case}
\NormalTok{  ))}

\CommentTok{\# Summarize data by categories and pathogenicity}
\NormalTok{summary\_df }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{clinvar\_clinical\_significance =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"likely\_benign"}\NormalTok{, }\StringTok{"benign"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"benign"}\NormalTok{,}
\NormalTok{    clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"likely\_pathogenic"}\NormalTok{, }\StringTok{"pathogenic"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"pathogenic"}\NormalTok{,}
    \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\NormalTok{ clinvar\_clinical\_significance  }\CommentTok{\# Keep other categories unchanged}
\NormalTok{  )) }\SpecialCharTok{\%\textgreater{}\%}
  \CommentTok{\# Group by the new clinical significance categories and stability}
  \FunctionTok{group\_by}\NormalTok{(clinvar\_clinical\_significance, stability) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{count =} \FunctionTok{n}\NormalTok{(), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \CommentTok{\# Recalculate percentages after merging}
  \FunctionTok{group\_by}\NormalTok{(clinvar\_clinical\_significance) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{percent =}\NormalTok{ (count }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(count)) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{ungroup}\NormalTok{()}

\NormalTok{summary\_df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 4
##   clinvar_clinical_significance stability     count percent
##   <chr>                         <chr>         <int>   <dbl>
## 1 benign                        WT-like        6139   63.4 
## 2 benign                        destabilizing  3177   32.8 
## 3 benign                        stabilizing     374    3.86
## 4 pathogenic                    WT-like        6282   30.3 
## 5 pathogenic                    destabilizing 14001   67.4 
## 6 pathogenic                    stabilizing     482    2.32
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Creating a contingency table}
\NormalTok{contingency\_table }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
\NormalTok{  summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"pathogenic"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{==} \StringTok{"destabilizing"}\NormalTok{], }
\NormalTok{  summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"benign"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{==} \StringTok{"destabilizing"}\NormalTok{],}
  \FunctionTok{sum}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"pathogenic"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{!=} \StringTok{"destabilizing"}\NormalTok{]),}
  \FunctionTok{sum}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{count[summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\SpecialCharTok{==} \StringTok{"benign"} \SpecialCharTok{\&}\NormalTok{ summary\_df}\SpecialCharTok{$}\NormalTok{stability }\SpecialCharTok{!=} \StringTok{"destabilizing"}\NormalTok{])}
\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Adding row and column names for clarity}
\FunctionTok{colnames}\NormalTok{(contingency\_table) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Pathogenic"}\NormalTok{, }\StringTok{"Benign"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(contingency\_table) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Destabilizing"}\NormalTok{, }\StringTok{"Non{-}Destabilizing"}\NormalTok{)}

\CommentTok{\# Displaying the table}
\FunctionTok{print}\NormalTok{(contingency\_table)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   Pathogenic Benign
## Destabilizing          14001   3177
## Non-Destabilizing       6764   6513
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#                   Pathogenic Benign}
\CommentTok{\# Destabilizing          14001   3177}
\CommentTok{\# Non{-}Destabilizing       6764   6513}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calculate the Odds Ratio using Fisher\textquotesingle{}s Test}
\NormalTok{result }\OtherTok{\textless{}{-}} \FunctionTok{fisher.test}\NormalTok{(contingency\_table)}
\NormalTok{result}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Fisher's Exact Test for Count Data
## 
## data:  contingency_table
## p-value < 2.2e-16
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  4.029904 4.469339
## sample estimates:
## odds ratio 
##   4.242931
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#   Fisher\textquotesingle{}s Exact Test for Count Data}
\CommentTok{\# }
\CommentTok{\# data:  contingency\_table}
\CommentTok{\# p{-}value \textless{} 2.2e{-}16}
\CommentTok{\# alternative hypothesis: true odds ratio is not equal to 1}
\CommentTok{\# 95 percent confidence interval:}
\CommentTok{\#  4.029904 4.469339}
\CommentTok{\# sample estimates:}
\CommentTok{\# odds ratio }
\CommentTok{\#   4.242931}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# \#                   Pathogenic Benign}
\CommentTok{\# \#Destabilizing          14001   3177}
\CommentTok{\# \#Non{-}Destabilizing       6764   6513}
\CommentTok{\# \# Create expanded binary vectors}
\CommentTok{\# y\_true \textless{}{-} c(}
\CommentTok{\#   rep(1, 14001),  \# pathogenic destabilizing}
\CommentTok{\#   rep(1, 6764),  \# pathogenic non{-}destabilizing}
\CommentTok{\#   rep(0, 3177),   \# benign destabilizing}
\CommentTok{\#   rep(0, 6513)   \# benign non{-}destabilizing}
\CommentTok{\# )}
\CommentTok{\# }
\CommentTok{\# \# Predicted labels or scores: 1 for destabilizing, 0 for not}
\CommentTok{\# y\_pred \textless{}{-} c(}
\CommentTok{\#   rep(1, 14001),  \# pathogenic destabilizing}
\CommentTok{\#   rep(0, 6764),  \# pathogenic non{-}destabilizing}
\CommentTok{\#   rep(1, 3177),   \# benign destabilizing}
\CommentTok{\#   rep(0, 6513)   \# benign non{-}destabilizing}
\CommentTok{\# )}
\CommentTok{\# }
\CommentTok{\# \# ROC AUC}
\CommentTok{\# roc\_obj \textless{}{-} roc(y\_true, y\_pred)}
\CommentTok{\# roc\_auc \textless{}{-} auc(roc\_obj)}
\CommentTok{\# }
\CommentTok{\# \# PR AUC}
\CommentTok{\# pr\_obj \textless{}{-} pr.curve(scores.class0 = y\_pred[y\_true == 1],}
\CommentTok{\#                    scores.class1 = y\_pred[y\_true == 0],}
\CommentTok{\#                    curve = TRUE)}
\CommentTok{\# pr\_auc \textless{}{-} pr\_obj$auc.integral}
\CommentTok{\# }
\CommentTok{\# \# Print results}
\CommentTok{\# cat("ROC{-}AUC:", round(roc\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#ROC{-}AUC: 0.6732}
\CommentTok{\# cat("PR{-}AUC:", round(pr\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#PR{-}AUC: 0.7893}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_df}\SpecialCharTok{$}\NormalTok{stability }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{stability, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"WT{-}like"}\NormalTok{, }\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{))}
\NormalTok{summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(summary\_df}\SpecialCharTok{$}\NormalTok{clinvar\_clinical\_significance, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"pathogenic"}\NormalTok{))}

\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil) }\CommentTok{\#30455}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30455
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(clinvar\_core\_fil}\SpecialCharTok{$}\NormalTok{uniprot)) }\CommentTok{\#5286}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5286
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p8 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(summary\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ clinvar\_clinical\_significance, }\AttributeTok{y =}\NormalTok{ percent, }\AttributeTok{fill =}\NormalTok{ stability)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"stack"}\NormalTok{, }\AttributeTok{width =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Stacked bars}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{paste0}\NormalTok{(}\FunctionTok{round}\NormalTok{(percent, }\DecValTok{1}\NormalTok{), }\StringTok{"\% ("}\NormalTok{, count, }\StringTok{")"}\NormalTok{)), }
            \AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =} \FloatTok{0.5}\NormalTok{), }\AttributeTok{size =} \DecValTok{4}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Center labels in stacks}
  \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set2"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"30,455 ClinVar Variants"}\NormalTok{, }\AttributeTok{subtitle =} \StringTok{"5,286 proteins"}\NormalTok{,}
       \AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \StringTok{"Variant percentage (\%)"}\NormalTok{, }\AttributeTok{fill =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{101}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
        \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{0}\NormalTok{),}
        \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{) ,}
        \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{) ,}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{))            }

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_core\_var\_clinvar\_barplot.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p8, }\AttributeTok{width =} \DecValTok{4}\NormalTok{, }\AttributeTok{height =} \DecValTok{4}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p8}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-15-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ALL SITES}
\CommentTok{\#                  Pathogenic Benign}
\CommentTok{\#Destabilizing          20549   6292}
\CommentTok{\#Non{-}Destabilizing      22027  65126}

\CommentTok{\# CORE}
\CommentTok{\#                   Pathogenic Benign}
\CommentTok{\#Destabilizing          14001   3177}
\CommentTok{\#Non{-}Destabilizing       6764   6513}

\CommentTok{\# EXPOSED}
\CommentTok{\#                   Pathogenic Benign}
\CommentTok{\#Destabilizing          6548   3115}
\CommentTok{\#Non{-}Destabilizing      15263  58,613}

\CommentTok{\# \# Replace these with real values}
\CommentTok{\# A \textless{}{-} 14001  \# buried \& destabilizing}
\CommentTok{\# B \textless{}{-} 6764  \# buried \& not destabilizing}
\CommentTok{\# C \textless{}{-} 6548  \# exposed \& destabilizing}
\CommentTok{\# D \textless{}{-} 15263  \# exposed \& not destabilizing}
\CommentTok{\# }
\CommentTok{\# \# Create vectors}
\CommentTok{\# y\_true \textless{}{-} c(rep(1, A), rep(0, B), rep(1, C), rep(0, D))  \# destabilizing = 1}
\CommentTok{\# y\_pred \textless{}{-} c(rep(1, A + B), rep(0, C + D))                \# buried = 1}
\CommentTok{\# }
\CommentTok{\# \# ROC AUC}
\CommentTok{\# roc\_obj \textless{}{-} roc(y\_true, y\_pred)}
\CommentTok{\# roc\_auc \textless{}{-} auc(roc\_obj)}
\CommentTok{\# pr\_obj \textless{}{-} pr.curve(scores.class0 = y\_pred[y\_true == 1],}
\CommentTok{\#                    scores.class1 = y\_pred[y\_true == 0],}
\CommentTok{\#                    curve = TRUE)}
\CommentTok{\# pr\_auc \textless{}{-} pr\_obj$auc.integral}
\CommentTok{\# \# Print results}
\CommentTok{\# cat("ROC{-}AUC:", round(roc\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#ROC{-}AUC: 0.6871}
\CommentTok{\# cat("PR{-}AUC:", round(pr\_auc, 4), "\textbackslash{}n")}
\CommentTok{\# \#PR{-}AUC: 0.6365}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create matrix}
\NormalTok{exposed\_mat }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
  \DecValTok{6548}\NormalTok{,   }\CommentTok{\# Pathogenic \& Destabilizing}
  \DecValTok{3115}\NormalTok{,   }\CommentTok{\# Benign \& Destabilizing}
  \DecValTok{15263}\NormalTok{,  }\CommentTok{\# Pathogenic \& Non{-}Destabilizing}
  \DecValTok{58613}   \CommentTok{\# Benign \& Non{-}Destabilizing}
\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{byrow =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Label rows and columns (optional for clarity)}
\FunctionTok{colnames}\NormalTok{(exposed\_mat) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Pathogenic"}\NormalTok{, }\StringTok{"Benign"}\NormalTok{)}
\FunctionTok{rownames}\NormalTok{(exposed\_mat) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Destabilizing"}\NormalTok{, }\StringTok{"Non{-}Destabilizing"}\NormalTok{)}

\CommentTok{\# Run Fisher\textquotesingle{}s Exact Test}
\FunctionTok{fisher.test}\NormalTok{(exposed\_mat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Fisher's Exact Test for Count Data
## 
## data:  exposed_mat
## p-value < 2.2e-16
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  7.706033 8.456029
## sample estimates:
## odds ratio 
##   8.071745
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#   Fisher\textquotesingle{}s Exact Test for Count Data}
\CommentTok{\# }
\CommentTok{\# data:  exposed\_mat}
\CommentTok{\# p{-}value \textless{} 2.2e{-}16}
\CommentTok{\# alternative hypothesis: true odds ratio is not equal to 1}
\CommentTok{\# 95 percent confidence interval:}
\CommentTok{\#  7.706033 8.456029}
\CommentTok{\# sample estimates:}
\CommentTok{\# odds ratio }
\CommentTok{\#   8.071745}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(clinvar\_core\_fil)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   variant      Model                   Dataset  ddG_pred      ESM.1v
## 1   R127W ThermoMPNN AF-A0A0B4J2F2-F1-model_v4 2.0698714 -11.5400913
## 2   H664Q ThermoMPNN AF-A0A1B0GTW7-F1-model_v4 1.2651348  -2.4089836
## 3   R389I ThermoMPNN AF-A0A1B0GTW7-F1-model_v4 0.9497069 -11.5089884
## 4   S384L ThermoMPNN AF-A0A1B0GTW7-F1-model_v4 3.6739409  -7.7639686
## 5   V396I ThermoMPNN     AF-A0AV02-F1-model_v4 0.1198671  -0.8185631
## 6   N263S ThermoMPNN     AF-A0AVF1-F1-model_v4 0.4268913 -11.9164503
##   new_position wildtype mutation exposure_rasa spot_disorder
## 1          127        R        W          0.07             0
## 2          664        H        Q          0.17             0
## 3          389        R        I          0.03             0
## 4          384        S        L          0.00             0
## 5          396        V        I          0.15             0
## 6          263        N        S          0.08             0
##   clinvar_clinical_significance chain    uniprot
## 1                    pathogenic     A A0A0B4J2F2
## 2                 likely_benign     A A0A1B0GTW7
## 3                    pathogenic     A A0A1B0GTW7
## 4                    pathogenic     A A0A1B0GTW7
## 5                 likely_benign     A     A0AV02
## 6             likely_pathogenic     A     A0AVF1
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            aa_sequence
## 1      MVIMSEFSADPAGQGQGQQKPLRVGFYDIERTLGKGNFAVVKLARHRVTKTQVAIKIIDKTRLDSSNLEKIYREVQLMKLLNHPHIIKLYQVMETKDMLYIVTEFAKNGEMFDYLTSNGHLSENEARKKFWQILSAVEYCHDHHIVHRDLKTENLLLDGNMDIKLADFGFGNFYKSGEPLSTWCGSPPYAAPEVFEGKEYEGPQLDIWSLGVVLYVLVCGSLPFDGPNLPTLRQRVLEGRFRIPFFMSQDCESLIRRMLVVDPARRITIAQIRQHRWMRAEPCLPGPACPAFSAHSYTSNLGDYDEQALGIMQTLGVDRQRTVESLQNSSYNHFAAIYYLLLERLKEYRNAQCARPGPARQPRPRSSDLSGLEVPQEGLSTDPFRPALLCPQPQTLVQSVLQAEMDCELQSSLQWPLFFPVDASCSGVFRPRPVSPSSLLDTAISEEARQGPGLEEEQDTQESLPSSTGRRHTLAEVSTRLSPLTAPCIVVSPSTTASPAEGTSSDSCLTFSASKSPAGLSGTPATQGLLGACSPVRLASPFLGSQSATPVLQAQGGLGGAVLLPVSFQEGRRASDTSLTQGLKAFRQQLRKTTRTKGFLGLNKIKGLARQVCQVPASRASRGGLSPFHAPAQSPGLHGGAAGSREGWSLLEEVLEQQRLLQLQHHPAAAPGCSQAPQPAPAPFVIAPCDGPGAAPLPSTLLTSGLPLLPPPLLQTGASPVASAAQLLDTHLHIGTGPTALPAVPPPRLARLAPGCEPLGLLQGDCEMEDLMPCSLGTFVLVQ
## 2 MLLLLLLLLLLPPLVLRVAASRCLHDETQKSVSLLRPPFSQLPSKSRSSSLTLPSSRDPQPLRIQSCYLGDHISDGAWDPEGEGMRGGSRALAAVREATQRIQAVLAVQGPLLLSRDPAQYCHAVWGDPDSPNYHRCSLLNPGYKGESCLGAKIPDTHLRGYALWPEQGPPQLVQPDGPGVQNTDFLLYVRVAHTSKCHQETVSLCCPGWSTAAQSQLTAALTSWAQRRGFVMLPRLCLKLLGSSNLPTLASQSIRITGPSVIAYAACCQLDSEDRPLAGTIVYCAQHLTSPSLSHSDIVMATLHELLHALGFSGQLFKKWRDCPSGFSVRENCSTRQLVTRQDEWGQLLLTTPAVSLSLAKHLGVSGASLGVPLEEEEGLLSSHWEARLLQGSLMTATFDGAQRTRLDPITLAAFKDSGWYQVNHSAAEELLWGQGSGPEFGLVTTCGTGSSDFFCTGSGLGCHYLHLDKGSCSSDPMLEGCRMYKPLANGSECWKKENGFPAGVDNPHGEIYHPQSRCFFANLTSQLLPGDKPRHPSLTPHLKEAELMGRCYLHQCTGRGAYKVQVEGSPWVPCLPGKVIQIPGYYGLLFCPRGRLCQTNEDINAVTSPPVSLSTPDPLFQLSLELAGPPGHSLGKEQQEGLAEAVLEALASKGGTGRCYFHGPSITTSLVFTVHMWKSPGCQGPSVATLHKALTLTLQKKPLEVYHGGANFTTQPSKLLVTSDHNPSMTHLRLSMGLCLMLLILVGVMGTTAYQKRATLPVRPSASYHSPELHSTRVPVRGIREV
## 3 MLLLLLLLLLLPPLVLRVAASRCLHDETQKSVSLLRPPFSQLPSKSRSSSLTLPSSRDPQPLRIQSCYLGDHISDGAWDPEGEGMRGGSRALAAVREATQRIQAVLAVQGPLLLSRDPAQYCHAVWGDPDSPNYHRCSLLNPGYKGESCLGAKIPDTHLRGYALWPEQGPPQLVQPDGPGVQNTDFLLYVRVAHTSKCHQETVSLCCPGWSTAAQSQLTAALTSWAQRRGFVMLPRLCLKLLGSSNLPTLASQSIRITGPSVIAYAACCQLDSEDRPLAGTIVYCAQHLTSPSLSHSDIVMATLHELLHALGFSGQLFKKWRDCPSGFSVRENCSTRQLVTRQDEWGQLLLTTPAVSLSLAKHLGVSGASLGVPLEEEEGLLSSHWEARLLQGSLMTATFDGAQRTRLDPITLAAFKDSGWYQVNHSAAEELLWGQGSGPEFGLVTTCGTGSSDFFCTGSGLGCHYLHLDKGSCSSDPMLEGCRMYKPLANGSECWKKENGFPAGVDNPHGEIYHPQSRCFFANLTSQLLPGDKPRHPSLTPHLKEAELMGRCYLHQCTGRGAYKVQVEGSPWVPCLPGKVIQIPGYYGLLFCPRGRLCQTNEDINAVTSPPVSLSTPDPLFQLSLELAGPPGHSLGKEQQEGLAEAVLEALASKGGTGRCYFHGPSITTSLVFTVHMWKSPGCQGPSVATLHKALTLTLQKKPLEVYHGGANFTTQPSKLLVTSDHNPSMTHLRLSMGLCLMLLILVGVMGTTAYQKRATLPVRPSASYHSPELHSTRVPVRGIREV
## 4 MLLLLLLLLLLPPLVLRVAASRCLHDETQKSVSLLRPPFSQLPSKSRSSSLTLPSSRDPQPLRIQSCYLGDHISDGAWDPEGEGMRGGSRALAAVREATQRIQAVLAVQGPLLLSRDPAQYCHAVWGDPDSPNYHRCSLLNPGYKGESCLGAKIPDTHLRGYALWPEQGPPQLVQPDGPGVQNTDFLLYVRVAHTSKCHQETVSLCCPGWSTAAQSQLTAALTSWAQRRGFVMLPRLCLKLLGSSNLPTLASQSIRITGPSVIAYAACCQLDSEDRPLAGTIVYCAQHLTSPSLSHSDIVMATLHELLHALGFSGQLFKKWRDCPSGFSVRENCSTRQLVTRQDEWGQLLLTTPAVSLSLAKHLGVSGASLGVPLEEEEGLLSSHWEARLLQGSLMTATFDGAQRTRLDPITLAAFKDSGWYQVNHSAAEELLWGQGSGPEFGLVTTCGTGSSDFFCTGSGLGCHYLHLDKGSCSSDPMLEGCRMYKPLANGSECWKKENGFPAGVDNPHGEIYHPQSRCFFANLTSQLLPGDKPRHPSLTPHLKEAELMGRCYLHQCTGRGAYKVQVEGSPWVPCLPGKVIQIPGYYGLLFCPRGRLCQTNEDINAVTSPPVSLSTPDPLFQLSLELAGPPGHSLGKEQQEGLAEAVLEALASKGGTGRCYFHGPSITTSLVFTVHMWKSPGCQGPSVATLHKALTLTLQKKPLEVYHGGANFTTQPSKLLVTSDHNPSMTHLRLSMGLCLMLLILVGVMGTTAYQKRATLPVRPSASYHSPELHSTRVPVRGIREV
## 5                                                                           MTQMSQVQELFHEAAQQDALAQPQPWWKTQLFMWEPVLFGTWDGVFTSCMINIFGVVLFLRTGWLVGNTGVLLGMFLVSFVILVALVTVLSGIGVGERSSIGSGGVYSMISSVLGGQTGGTIGLLYVFGQCVAGAMYITGFAESISDLLGLGNIWAVRGISVAVLLALLGINLAGVKWIIRLQLLLLFLLAVSTLDFVVGSFTHLDPEHGFIGYSPELLQNNTLPDYSPGESFFTVFGVFFPAATGVMAGFNMGGDLREPAASIPLGSLAAVGISWFLYIIFVFLLGAICTREALRYDFLIAEKVSLMGFLFLLGLYISSLASCMGGLYGAPRILQCIAQEKVIPALACLGQGKGPNKTPVAAICLTSLVTMAFVFVGQVNVLAPIVTINFMLTYVAVDYSYFSLSMCSCSLTPVPEPVLREGAEGLHCSEHLLLEKAPSYGSEGPAQRVLEGTLLEFTKDMDQLLQLTRKLESSQPRQGEGNRTPESQKRKSKKATKQTLQDSFLLDLKSPPSFPVEISDRLPAASWEGQESCWNKQTSKSEGTQPEGTYGEQLVPELCNQSESSGEDFFLKSRLQEQDVWRRSTSFYTHMCNPWVSLLGAVGSLLIMFVIQWVYTLVNMGVAAIVYFYIGRASPGLHLGSASNFSFFRWMRSLLLPSCRSLRSPQEQIILAPSLAKVDMEMTQLTQENADFATRDRYHHSSLVNREQLMPHY
## 6                                                                                                                                                                                                                                           MMLSRAKPAVGRGVQHTDKRKKKGRKIPKLEELLSKRDFTGAITLLEFKRHVGEEEEDTNLWIGYCAFHLGDYKRALEEYENATKEENCNSEVWVNLACTYFFLGMYKQAEAAGFKASKSRLQNRLLFHLAHKFNDEKKLMSFHQNLQDVTEDQLSLASIHYMRSHYQEAIDIYKRILLDNREYLALNVYVALCYYKLDYYDVSQEVLAVYLQQIPDSTIALNLKACNHFRLYNGRAAEAELKSLMDNASSSFEFAKELIRHNLVVFRGGEGALQVLPPLVDVIPEARLNLVIYYLRQDDVQEAYNLIKDLEPTTPQEYILKGVVNAALGQEMGSRDHMKIAQQFFQLVGGSASECDTIPGRQCMASCFFLLKQFDDVLIYLNSFKSYFYNDDIFNFNYAQAKAATGNTSEGEEAFLLIQSEKMKNDYIYLSWLARCYIMNKKPRLAWELYLKMETSGESFSLLQLIANDCYKMGQFYYSAKAFDVLERLDPNPEYWEGKRGACVGIFQMIIAGREPKETLREVLHLLRSTGNTQVEYMIRIMKKWAKENRVSI
##       stability
## 1 destabilizing
## 2 destabilizing
## 3       WT-like
## 4 destabilizing
## 5       WT-like
## 6       WT-like
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil\_anno }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(clinvar\_core\_fil, protein\_atlas\_anno, }\AttributeTok{by=}\StringTok{"uniprot"}\NormalTok{, }\AttributeTok{all.x =} \ConstantTok{TRUE}\NormalTok{ )}
\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil\_anno) }\CommentTok{\#90662\textless{}{-} same protein can be part of multiple groups }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 90662
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(clinvar\_core\_fil\_anno}\SpecialCharTok{$}\NormalTok{uniprot)) }\CommentTok{\#5286}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5286
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil\_anno }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(source\_file))}
\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil\_anno) }\CommentTok{\#90626}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 90626
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil\_anno}\SpecialCharTok{$}\NormalTok{source\_file }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_"}\NormalTok{, }\StringTok{" "}\NormalTok{, clinvar\_core\_fil\_anno}\SpecialCharTok{$}\NormalTok{source\_file)}

\NormalTok{clinvar\_core\_fil\_anno\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"pathogenic"}\NormalTok{, }\StringTok{"likely\_pathogenic"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil\_anno\_patho) }\CommentTok{\#65952}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 65952
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{variant\_counts\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil\_anno\_patho }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(source\_file) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{total\_variants =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{non\_wt\_like =} \FunctionTok{sum}\NormalTok{(stability }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{)),}
    \AttributeTok{fraction\_non\_wt\_like =}\NormalTok{ non\_wt\_like }\SpecialCharTok{/}\NormalTok{ total\_variants}
\NormalTok{  )}

\NormalTok{variant\_counts\_patho}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 23 x 4
##    source_file                   total_variants non_wt_like fraction_non_wt_like
##    <chr>                                  <int>       <int>                <dbl>
##  1 G protein coupled receptors              330         185                0.561
##  2 RAS pathway related proteins             603         385                0.638
##  3 RNA polymerase related prote~             37          25                0.676
##  4 accessory factors involved i~            748         545                0.729
##  5 blood group antigen proteins              33          23                0.697
##  6 cd markers                               660         513                0.777
##  7 citric acid cycle related pr~            195         122                0.626
##  8 electrochemical potential dr~           1133         687                0.606
##  9 enzyme proteins                         9753        6943                0.712
## 10 kinases                                 1066         764                0.717
## # i 13 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p4 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(variant\_counts\_patho, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(source\_file, }\SpecialCharTok{{-}}\NormalTok{fraction\_non\_wt\_like),  }\CommentTok{\# Order by fraction}
                           \AttributeTok{y =}\NormalTok{ fraction\_non\_wt\_like, }
                           \AttributeTok{fill =}\NormalTok{ source\_file)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#0072B2"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Bar plot}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(fraction\_non\_wt\_like, }\DecValTok{2}\NormalTok{)), }
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Labels on bars}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"65,952 Pathogenic \& Likely Pathogenic ClinVar Variants"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Core variants"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{""}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"\% of Stability{-}related Variants"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#333333"}\NormalTok{),  }\CommentTok{\# Bold title for emphasis}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#666666"}\NormalTok{),  }\CommentTok{\# Lighter subtitle}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}
\NormalTok{  ) }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_clinvar\_patho\_core\_protein\_type.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p4, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p4}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-20-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_core\_fil\_anno\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"likely\_benign"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(clinvar\_core\_fil\_anno\_benign) }\CommentTok{\#24674}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 24674
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{variant\_counts\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_core\_fil\_anno\_benign }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(source\_file) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{total\_variants =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{non\_wt\_like =} \FunctionTok{sum}\NormalTok{(stability }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{)),}
    \AttributeTok{fraction\_non\_wt\_like =}\NormalTok{ non\_wt\_like }\SpecialCharTok{/}\NormalTok{ total\_variants}
\NormalTok{  )}

\NormalTok{variant\_counts\_benign}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 23 x 4
##    source_file                   total_variants non_wt_like fraction_non_wt_like
##    <chr>                                  <int>       <int>                <dbl>
##  1 G protein coupled receptors              362          96                0.265
##  2 RAS pathway related proteins             216          86                0.398
##  3 RNA polymerase related prote~             13           3                0.231
##  4 accessory factors involved i~            317         126                0.397
##  5 blood group antigen proteins              22          12                0.545
##  6 cd markers                               434         174                0.401
##  7 citric acid cycle related pr~             39          18                0.462
##  8 electrochemical potential dr~            418         127                0.304
##  9 enzyme proteins                         2869        1077                0.375
## 10 kinases                                  373         148                0.397
## # i 13 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p5 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(variant\_counts\_benign, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(source\_file, }\SpecialCharTok{{-}}\NormalTok{fraction\_non\_wt\_like),  }\CommentTok{\# Order by fraction}
                           \AttributeTok{y =}\NormalTok{ fraction\_non\_wt\_like, }
                           \AttributeTok{fill =}\NormalTok{ source\_file)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#0072B2"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Bar plot}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(fraction\_non\_wt\_like, }\DecValTok{2}\NormalTok{)), }
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Labels on bars}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"24,674 Benign \& Likely Benign ClinVar Variants"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Core variants"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{""}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"\% of Stability{-}related Variants"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#333333"}\NormalTok{),  }\CommentTok{\# Bold title for emphasis}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#666666"}\NormalTok{),  }\CommentTok{\# Lighter subtitle}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}
\NormalTok{  ) }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_clinvar\_benign\_core\_protein\_type.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p5, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p5}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-22-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var\_anno }\OtherTok{\textless{}{-}} \FunctionTok{merge}\NormalTok{(clinvar\_all\_var, protein\_atlas\_anno, }\AttributeTok{by=}\StringTok{"uniprot"}\NormalTok{, }\AttributeTok{all.x =} \ConstantTok{TRUE}\NormalTok{ )}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var\_anno) }\CommentTok{\#294935\textless{}{-} same protein can be part of multiple groups }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 294935
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(clinvar\_all\_var\_anno}\SpecialCharTok{$}\NormalTok{uniprot)) }\CommentTok{\#12336}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 12336
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var\_anno }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(source\_file))}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var\_anno) }\CommentTok{\#294729}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 294729
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var\_anno}\SpecialCharTok{$}\NormalTok{source\_file }\OtherTok{\textless{}{-}} \FunctionTok{gsub}\NormalTok{(}\StringTok{"\_"}\NormalTok{, }\StringTok{" "}\NormalTok{, clinvar\_all\_var\_anno}\SpecialCharTok{$}\NormalTok{source\_file)}

\NormalTok{clinvar\_all\_var\_anno\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"pathogenic"}\NormalTok{, }\StringTok{"likely\_pathogenic"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var\_anno\_patho) }\CommentTok{\#128512}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 128512
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{variant\_counts\_patho }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var\_anno\_patho }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(source\_file) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{total\_variants =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{non\_wt\_like =} \FunctionTok{sum}\NormalTok{(stability }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{)),}
    \AttributeTok{fraction\_non\_wt\_like =}\NormalTok{ non\_wt\_like }\SpecialCharTok{/}\NormalTok{ total\_variants}
\NormalTok{  )}

\NormalTok{variant\_counts\_patho}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 23 x 4
##    source_file                   total_variants non_wt_like fraction_non_wt_like
##    <chr>                                  <int>       <int>                <dbl>
##  1 G protein coupled receptors              574         270                0.470
##  2 RAS pathway related proteins            1772         789                0.445
##  3 RNA polymerase related prote~             75          35                0.467
##  4 accessory factors involved i~           1540         809                0.525
##  5 blood group antigen proteins              44          26                0.591
##  6 cd markers                              1244         729                0.586
##  7 citric acid cycle related pr~            407         189                0.464
##  8 electrochemical potential dr~           1632         895                0.548
##  9 enzyme proteins                        16308        9565                0.587
## 10 kinases                                 2307        1227                0.532
## # i 13 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(variant\_counts\_patho, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(source\_file, }\SpecialCharTok{{-}}\NormalTok{fraction\_non\_wt\_like),  }\CommentTok{\# Order by fraction}
                           \AttributeTok{y =}\NormalTok{ fraction\_non\_wt\_like, }
                           \AttributeTok{fill =}\NormalTok{ source\_file)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#0072B2"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Bar plot}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(fraction\_non\_wt\_like, }\DecValTok{2}\NormalTok{)), }
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Labels on bars}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"128,512 Pathogenic \& Likely Pathogenic ClinVar Variants"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"All variants"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{""}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"\% of Stability{-}related Variants"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#333333"}\NormalTok{),  }\CommentTok{\# Bold title for emphasis}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#666666"}\NormalTok{),  }\CommentTok{\# Lighter subtitle}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}
\NormalTok{  ) }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_clinvar\_patho\_all\_protein\_type.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p2, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p2}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-24-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clinvar\_all\_var\_anno\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var\_anno }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(clinvar\_clinical\_significance }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"benign"}\NormalTok{, }\StringTok{"likely\_benign"}\NormalTok{))}
\FunctionTok{nrow}\NormalTok{(clinvar\_all\_var\_anno\_benign) }\CommentTok{\#166217}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 166217
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{variant\_counts\_benign }\OtherTok{\textless{}{-}}\NormalTok{ clinvar\_all\_var\_anno\_benign }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(source\_file) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{total\_variants =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{non\_wt\_like =} \FunctionTok{sum}\NormalTok{(stability }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"destabilizing"}\NormalTok{, }\StringTok{"stabilizing"}\NormalTok{)),}
    \AttributeTok{fraction\_non\_wt\_like =}\NormalTok{ non\_wt\_like }\SpecialCharTok{/}\NormalTok{ total\_variants}
\NormalTok{  )}

\NormalTok{variant\_counts\_benign}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 23 x 4
##    source_file                   total_variants non_wt_like fraction_non_wt_like
##    <chr>                                  <int>       <int>                <dbl>
##  1 G protein coupled receptors             1656         247               0.149 
##  2 RAS pathway related proteins            1658         178               0.107 
##  3 RNA polymerase related prote~             60           8               0.133 
##  4 accessory factors involved i~           2051         248               0.121 
##  5 blood group antigen proteins             125          27               0.216 
##  6 cd markers                              2429         385               0.159 
##  7 citric acid cycle related pr~            174          34               0.195 
##  8 electrochemical potential dr~           2008         261               0.130 
##  9 enzyme proteins                        15768        2309               0.146 
## 10 kinases                                 3282         298               0.0908
## # i 13 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(variant\_counts\_benign, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{reorder}\NormalTok{(source\_file, }\SpecialCharTok{{-}}\NormalTok{fraction\_non\_wt\_like),  }\CommentTok{\# Order by fraction}
                           \AttributeTok{y =}\NormalTok{ fraction\_non\_wt\_like, }
                           \AttributeTok{fill =}\NormalTok{ source\_file)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{fill =} \StringTok{"\#0072B2"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Bar plot}
  \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =} \FunctionTok{round}\NormalTok{(fraction\_non\_wt\_like, }\DecValTok{2}\NormalTok{)), }
            \AttributeTok{vjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Labels on bars}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"166,217 Benign \& Likely Benign ClinVar Variants"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"All variants"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{""}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"\% of Stability{-}related Variants"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{16}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#333333"}\NormalTok{),  }\CommentTok{\# Bold title for emphasis}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{color =} \StringTok{"\#666666"}\NormalTok{),  }\CommentTok{\# Lighter subtitle}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.text.y =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{legend.position =} \StringTok{"none"}
\NormalTok{  ) }\SpecialCharTok{+} \FunctionTok{ylim}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\FunctionTok{ggsave}\NormalTok{(}\StringTok{"/lustre/scratch126/gengen/projects\_v2/alpha{-}allostery{-}global/git\_allostery\_pathogenicity/figs/panels/fig1\_clinvar\_benign\_all\_protein\_type.pdf"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ p3, }\AttributeTok{width =} \DecValTok{10}\NormalTok{, }\AttributeTok{height =} \DecValTok{5}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\NormalTok{p3}
\end{Highlighting}
\end{Shaded}

\includegraphics{1.hpc_fig1_files/figure-latex/unnamed-chunk-26-1.pdf}

\end{document}
